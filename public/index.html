<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medical Screening Dashboard - VAPI CRM</title>
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <div class="dashboard-container">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="header-content">
                <h1>üè• Medical Screening Dashboard</h1>
                <div class="header-actions">
                    <a href="/monitoring.html" class="btn btn-monitoring">
                        üìä VAPI/VICI Monitoring
                    </a>
                    <button id="refreshBtn" class="btn btn-primary">
                        <span id="refreshIcon">üîÑ</span> Refresh
                    </button>
                    <div class="status-indicator" id="statusIndicator">
                        <span class="status-dot"></span>
                        <span id="statusText">Loading...</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="tabs-nav">
            <button class="tab-btn active" data-tab="overview">üìä Overview</button>
            <button class="tab-btn" data-tab="leads">üë• Leads</button>
            <button class="tab-btn" data-tab="users">üìã User Data</button>
            <button class="tab-btn" data-tab="classifications">‚úÖ Classifications</button>
        </nav>

        <!-- Main Content -->
        <main class="dashboard-main">

            <!-- Overview Tab -->
            <div id="overview" class="tab-content active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üë•</div>
                        <div class="stat-info">
                            <h3 id="totalLeads">-</h3>
                            <p>Total Leads</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üìù</div>
                        <div class="stat-info">
                            <h3 id="totalUsers">-</h3>
                            <p>Users with Data</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚úÖ</div>
                        <div class="stat-info">
                            <h3 id="totalClassifications">-</h3>
                            <p>Classifications</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üìà</div>
                        <div class="stat-info">
                            <h3 id="completionRate">-</h3>
                            <p>Data Completion</p>
                        </div>
                    </div>
                </div>

                <div class="overview-section">
                    <h2>Recent Activity</h2>
                    <div id="recentActivity" class="activity-list">
                        <p class="loading">Loading activity...</p>
                    </div>
                </div>

                <div class="overview-charts">
                    <div class="chart-card">
                        <h3>Classification Results</h3>
                        <div id="classificationChart" class="chart-container">
                            <div class="chart-bars">
                                <div class="chart-bar-group">
                                    <div class="chart-bar qualified">
                                        <span class="chart-bar-value" id="qualifiedCount">0</span>
                                    </div>
                                    <span class="chart-label">Qualified</span>
                                </div>
                                <div class="chart-bar-group">
                                    <div class="chart-bar not-qualified">
                                        <span class="chart-bar-value" id="notQualifiedCount">0</span>
                                    </div>
                                    <span class="chart-label">Not Qualified</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Leads Tab -->
            <div id="leads" class="tab-content">
                <div class="content-header">
                    <h2>All Leads</h2>
                    <div class="search-box">
                        <input type="text" id="leadsSearch" placeholder="üîç Search by name, phone, or email...">
                    </div>
                </div>
                <div class="table-container">
                    <table id="leadsTable" class="data-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Phone Number</th>
                                <th>Email</th>
                                <th>Source</th>
                                <th>Created</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="leadsTableBody">
                            <tr>
                                <td colspan="6" class="loading">Loading leads...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Users Tab -->
            <div id="users" class="tab-content">
                <div class="content-header">
                    <h2>User Data</h2>
                    <div class="search-box">
                        <input type="text" id="usersSearch" placeholder="üîç Search by name or phone...">
                    </div>
                </div>
                <div id="usersGrid" class="users-grid">
                    <p class="loading">Loading user data...</p>
                </div>
            </div>

            <!-- Classifications Tab -->
            <div id="classifications" class="tab-content">
                <div class="content-header">
                    <h2>Classification Results</h2>
                    <div class="filter-buttons">
                        <button class="filter-btn active" data-filter="all">All</button>
                        <button class="filter-btn" data-filter="QUALIFIED">‚úÖ Qualified</button>
                        <button class="filter-btn" data-filter="NOT_QUALIFIED">‚ùå Not Qualified</button>
                    </div>
                </div>
                <div id="classificationsGrid" class="classifications-grid">
                    <p class="loading">Loading classifications...</p>
                </div>
            </div>

        </main>

        <!-- Modal for detailed view -->
        <div id="detailModal" class="modal">
            <div class="modal-content">
                <span class="modal-close">&times;</span>
                <div id="modalBody"></div>
            </div>
        </div>
    </div>

    <script src="/js/api.js"></script>
    <script src="/js/app.js"></script>

    <!-- VAPI Voice Widget -->
    <vapi-widget
      public-key="f9cd8c4c-309e-4ade-90da-7757d0cdc9ef"
      assistant-id="8d220827-055b-4bc0-85ab-e740e5512b4b"
      mode="voice"
      theme="dark"
      base-bg-color="#000000"
      accent-color="#14B8A6"
      cta-button-color="#000000"
      cta-button-text-color="#ffffff"
      border-radius="large"
      size="full"
      position="bottom-right"
      title="TALK WITH AI"
      start-button-text="Start"
      end-button-text="End Call"
      chat-first-message="Hey, How can I help you today?"
      chat-placeholder="Type your message..."
      voice-show-transcript="true"
      consent-required="true"
      consent-title="Terms and conditions"
      consent-content="By clicking "Agree," and each time I interact with this AI agent, I consent to the recording, storage, and sharing of my communications with third-party service providers, and as otherwise described in our Terms of Service."
      consent-storage-key="vapi_widget_consent"
    ></vapi-widget>

    <script src="https://unpkg.com/@vapi-ai/client-sdk-react/dist/embed/widget.umd.js" async type="text/javascript"></script>
</body>
</html>
